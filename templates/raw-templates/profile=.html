<!-- Profile Dropdown -->
<div id="profileMenu" class="absolute bottom-full left-0 w-full mb-2 hidden profile-menu">
    <div class="mx-4 bg-[hsl(var(--background))] border border-[hsl(var(--border))] rounded-lg shadow-lg overflow-hidden">
        <!-- Profile Info Section -->
        <div class="p-4 border-b border-[hsl(var(--border))]">
            <div class="flex items-center gap-3">
                {% if user.profile.profile_picture %}
                    <img src="{{ user.profile.profile_picture.url }}" alt="Profile Picture" class="w-12 h-12 rounded-full object-cover border-2 border-[hsl(var(--border))]">
                {% else %}
                    <div class="w-12 h-12 rounded-full bg-[hsl(var(--muted))] flex items-center justify-center text-[hsl(var(--muted-foreground))] text-xl font-semibold">
                        {{ user.username|make_list|first|upper }}
                    </div>
                {% endif %}
                <div class="flex-1">
                    <h3 class="font-semibold">{{ user.profile.full_name }}</h3>
                    <p class="text-sm text-[hsl(var(--muted-foreground))]">{{ user.email }}</p>
                </div>
            </div>
            {% if user.profile.position and user.profile.department %}
                <div class="mt-2 text-sm text-[hsl(var(--muted-foreground))]">
                    {{ user.profile.position }} â€¢ {{ user.profile.department }}
                </div>
            {% endif %}
        </div>
        
        <!-- Actions Section -->
        <div class="p-2">
            <a href="{% url 'permission:view_profile' %}" class="flex items-center w-full gap-2 p-2 rounded-md hover:bg-[hsl(var(--accent))] transition-colors">
                <svg class="w-4 h-4" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <path d="M15 12C15 13.6569 13.6569 15 12 15C10.3431 15 9 13.6569 9 12C9 10.3431 10.3431 9 12 9C13.6569 9 15 10.3431 15 12Z" stroke="currentColor" stroke-width="2"/>
                    <path d="M2.45825 12C3.73253 7.94288 7.52281 5 12.0004 5C16.4781 5 20.2684 7.94291 21.5426 12C20.2684 16.0571 16.4781 19 12.0005 19C7.52281 19 3.73251 16.0571 2.45825 12Z" stroke="currentColor" stroke-width="2"/>
                </svg>
                <span>View Profile</span>
            </a>
            <a href="{% url 'permission:edit_profile' %}" class="flex items-center w-full gap-2 p-2 rounded-md hover:bg-[hsl(var(--accent))] transition-colors">
                <svg class="w-4 h-4" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <path d="M11 4H4C3.46957 4 2.96086 4.21071 2.58579 4.58579C2.21071 4.96086 2 5.46957 2 6V20C2 20.5304 2.21071 21.0391 2.58579 21.4142C2.96086 21.7893 3.46957 22 4 22H18C18.5304 22 19.0391 21.7893 19.4142 21.4142C19.7893 21.0391 20 20.5304 20 20V13" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                    <path d="M18.5 2.50001C18.8978 2.10219 19.4374 1.87869 20 1.87869C20.5626 1.87869 21.1022 2.10219 21.5 2.50001C21.8978 2.89784 22.1213 3.4374 22.1213 4.00001C22.1213 4.56262 21.8978 5.10219 21.5 5.50001L12 15L8 16L9 12L18.5 2.50001Z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                </svg>
                <span>Edit Profile</span>
            </a>
        </div>
        
        <!-- Logout Section -->
        <div class="border-t border-[hsl(var(--border))] p-2">
            <form method="post" action="{% url 'permission:logout' %}">
                {% csrf_token %}
                <button type="submit" class="flex items-center w-full gap-2 p-2 rounded-md text-red-500 hover:bg-red-50 dark:hover:bg-red-950/50 transition-colors">
                    <svg class="w-4 h-4" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <path d="M16 17L21 12M21 12L16 7M21 12H9M9 3H7.8C6.11984 3 5.27976 3 4.63803 3.32698C4.07354 3.6146 3.6146 4.07354 3.32698 4.63803C3 5.27976 3 6.11984 3 7.8V16.2C3 17.8802 3 18.7202 3.32698 19.362C3.6146 19.9265 4.07354 20.3854 4.63803 20.673C5.27976 21 6.11984 21 7.8 21H9" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                    </svg>
                    <span>Log out</span>
                </button>
            </form>
        </div>
    </div>
</div>