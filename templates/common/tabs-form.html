{% extends 'base.html' %}
{% load static %}

{% block content %}
<div class="w-full mx-auto p-3 sm:p-6">
    <div class="rounded-2xl border-2 bg-[hsl(var(--background-card))] shadow-2xl p-6 sm:p-10 mb-8 premium-card relative overflow-hidden">
        <!-- Enhanced Decorative Elements -->
        <div class="absolute top-0 right-0 w-32 sm:w-40 h-32 sm:h-40 bg-gradient-to-br from-[hsl(var(--primary)/0.08)] to-transparent opacity-20 rounded-bl-full"></div>
        <div class="absolute bottom-0 left-0 w-32 sm:w-40 h-32 sm:h-40 bg-gradient-to-tr from-[hsl(var(--primary)/0.08)] to-transparent opacity-20 rounded-tr-full"></div>
        <div class="absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 w-96 h-96 bg-gradient-to-r from-[hsl(var(--primary)/0.03)] to-[hsl(var(--accent)/0.03)] rounded-full blur-3xl"></div>
        
        <!-- Enhanced Form Header -->
        <div class="mb-8 sm:mb-12 border-b border-[hsl(var(--border))] pb-6 sm:pb-8 relative z-10">
            <div class="flex flex-col sm:flex-row sm:items-center sm:justify-between gap-6">
                <div class="flex items-center gap-4 sm:gap-6">
   
                    <div>
                        <h3 class="text-2xl sm:text-3xl font-bold bg-gradient-to-r from-[hsl(var(--primary))] to-[hsl(var(--accent-foreground))] bg-clip-text text-transparent mb-2">{{ title }}</h3>
                        <p class="text-sm sm:text-base text-[hsl(var(--muted-foreground))] font-medium">Update your {{ model_name }} information with enhanced controls</p>
                    </div>
                </div>
                <div class="flex items-center justify-center px-4 py-2.5 sm:px-6 sm:py-3 text-xs sm:text-sm font-bold rounded-full bg-gradient-to-r from-[hsl(var(--primary)/0.9)] to-[hsl(var(--primary)/1.1)] text-[hsl(var(--primary-foreground))] shadow-lg premium-badge">
                    PREMIUM PLUS
                </div>
            </div>
        </div>

        <!-- Enhanced Scrollable Responsive Tabs Navigation -->
        <div class="relative mb-8 sm:mb-10 p-4 sm:p-6 rounded-2xl border-2 border-[hsl(var(--border-light))] bg-gradient-to-br from-[hsl(var(--background-tabs-start))] to-[hsl(var(--background-tabs-end))] shadow-inner-lg"> {# MODIFIED: Added custom variables for tabs background and inner shadow #}
            <!-- Scroll Left Button -->
            <button id="scrollLeft" class="absolute left-0 top-1/2 -translate-y-1/2 z-20 w-10 h-10 bg-[hsl(var(--background-card))] border-2 border-[hsl(var(--border))] rounded-full shadow-lg hover:shadow-xl transition-all duration-300 flex items-center justify-center opacity-0 pointer-events-none lg:opacity-100 lg:pointer-events-auto hover:bg-[hsl(var(--accent))] hover:border-[hsl(var(--primary))]">
                <svg class="w-5 h-5 text-[hsl(var(--muted-foreground))] hover:text-[hsl(var(--primary))]" viewBox="0 0 24 24" fill="none">
                    <path d="M15 18L9 12L15 6" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                </svg>
            </button>
            
            <!-- Scroll Right Button -->
            <button id="scrollRight" class="absolute right-0 top-1/2 -translate-y-1/2 z-20 w-10 h-10 bg-[hsl(var(--background-card))] border-2 border-[hsl(var(--border))] rounded-full shadow-lg hover:shadow-xl transition-all duration-300 flex items-center justify-center opacity-0 pointer-events-none lg:opacity-100 lg:pointer-events-auto hover:bg-[hsl(var(--accent))] hover:border-[hsl(var(--primary))]">
                <svg class="w-5 h-5 text-[hsl(var(--muted-foreground))] hover:text-[hsl(var(--primary))]" viewBox="0 0 24 24" fill="none">
                    <path d="M9 18L15 12L9 6" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                </svg>
            </button>

            <!-- Tabs Container with Enhanced Scrolling -->
            <div class="tabs-container-wrapper relative mx-0 lg:mx-12">
                <div id="tabsContainer" class="tabs-container overflow-x-auto overflow-y-hidden hide-scrollbar scroll-smooth pb-3" style="scrollbar-width: none; -ms-overflow-style: none;">
                    <div class="flex flex-nowrap gap-3 sm:gap-4 min-w-max px-2" role="tablist">
                        {% for fieldset in form.fieldsets %}
                        <button
                            id="tab-{{ fieldset.title|slugify }}"
                            role="tab"
                            data-tab="{{ fieldset.title|slugify }}"
                            class="tab-button flex items-center gap-3 px-4 py-3.5 sm:px-6 sm:py-4 rounded-xl premium-input whitespace-nowrap transition-all duration-300 flex-shrink-0 min-w-fit shadow-md hover:shadow-lg group {% if forloop.first %}bg-gradient-to-r from-[hsl(var(--primary)/0.9)] to-[hsl(var(--primary)/1.1)] text-[hsl(var(--primary-foreground))] shadow-lg active-tab{% else %}text-[hsl(var(--muted-foreground))] bg-[hsl(var(--background-tab-inactive))] hover:bg-[hsl(var(--accent))] hover:text-[hsl(var(--accent-foreground))] border-2 border-[hsl(var(--border-light))]{% endif %}" {# MODIFIED: Inactive tab background and border #}
                        >
                            <div class="flex items-center justify-center transition-transform duration-300 {% if forloop.first %}scale-110{% endif %}">
                                <svg class="w-5 h-5 sm:w-6 sm:h-6" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                                    {% if fieldset.icon == 'info' %}
                                        <circle cx="12" cy="12" r="10" stroke="currentColor" stroke-width="2"/>
                                        <path d="M12 16V12M12 8H12.01" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                                    {% elif fieldset.icon == 'ruler' %}
                                        <path d="M21 6H3" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
                                        <path d="M21 10H3" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
                                        <path d="M21 14H3" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
                                        <path d="M21 18H3" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
                                    {% elif fieldset.icon == 'tag' %}
                                        <path d="M20.59 13.41l-7.17 7.17a2 2 0 0 1-2.83 0L2 12V2h10l8.59 8.59a2 2 0 0 1 0 2.82z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                                        <line x1="7" y1="7" x2="7.01" y2="7" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                                    {% elif fieldset.icon == 'box' %}
                                        <path d="M21 16V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                                        <polyline points="3.27 6.96 12 12.01 20.73 6.96" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                                        <line x1="12" y1="22.08" x2="12" y2="12" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                                    {% elif fieldset.icon == 'bar-chart' %}
                                        <path d="M18 20V10" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                                        <path d="M12 20V4" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                                        <path d="M6 20V14" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                                    {% elif fieldset.icon == 'package' %}
                                        <line x1="16.5" y1="9.4" x2="7.5" y2="4.21" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                                        <path d="M21 16V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                                        <polyline points="3.27 6.96 12 12.01 20.73 6.96" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                                        <line x1="12" y1="22.08" x2="12" y2="12" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                                    {% elif fieldset.icon == 'calendar' %}
                                        <rect x="3" y="4" width="18" height="18" rx="2" ry="2" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                                        <line x1="16" y1="2" x2="16" y2="6" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                                        <line x1="8" y1="2" x2="8" y2="6" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                                        <line x1="3" y1="10" x2="21" y2="10" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                                    {% else %}
                                        <circle cx="12" cy="12" r="10" stroke="currentColor" stroke-width="2"/>
                                        <path d="M12 16V12M12 8H12.01" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                                    {% endif %}
                                </svg>
                            </div>
                            <div class="flex flex-col items-start">
                                <span class="font-semibold text-sm sm:text-base">{{ fieldset.title }}</span>
                                <span class="hidden sm:inline text-xs opacity-90 font-medium">{{ fieldset.description }}</span>
                            </div>
                        </button>
                        {% endfor %}
                    </div>
                </div>
                
                <!-- Enhanced Gradient Scroll Indicators -->
                <div id="leftGradient" class="absolute left-0 top-0 bottom-0 w-8 bg-gradient-to-r from-[hsl(var(--background-tabs-start))] to-transparent pointer-events-none opacity-0 transition-opacity duration-300 z-10"></div> {# MODIFIED: Updated gradient color to match new tabs wrapper background #}
                <div id="rightGradient" class="absolute right-0 top-0 bottom-0 w-8 bg-gradient-to-l from-[hsl(var(--background-tabs-end))] to-transparent pointer-events-none opacity-0 transition-opacity duration-300 z-10"></div> {# MODIFIED: Updated gradient color to match new tabs wrapper background #}
            </div>

            <!-- Mobile Scroll Indicators (Dots) -->
            <div class="flex justify-center mt-4 lg:hidden">
                <div id="tabIndicators" class="flex gap-2">
                    {% for fieldset in form.fieldsets %}
                    <div class="tab-indicator w-2 h-2 rounded-full transition-all duration-300 {% if forloop.first %}bg-[hsl(var(--primary))] scale-125{% else %}bg-[hsl(var(--muted))]{% endif %}" data-tab="{{ fieldset.title|slugify }}"></div>
                    {% endfor %}
                </div>
            </div>
        </div>

        <!-- Enhanced Tab Content -->
        <form method="post" enctype="multipart/form-data" class="space-y-6 sm:space-y-8 relative z-10">
            {% csrf_token %}
            

            <!-- Enhanced Form Errors Summary -->
            {% if form.errors %}
            <div class="mb-6 sm:mb-8 p-4 sm:p-6 rounded-xl premium-input border-2 border-red-500 bg-gradient-to-r from-red-50 to-red-100 shadow-lg">
                <div class="flex items-start mb-3">
                    <svg class="w-6 h-6 sm:w-7 sm:h-7 mr-3 text-red-600 mt-0.5 flex-shrink-0" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <circle cx="12" cy="12" r="10" stroke="currentColor" stroke-width="2"/>
                        <path d="M12 8V12" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
                        <path d="M12 16H12.01" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
                    </svg>
                    <div>
                        <h4 class="text-lg sm:text-xl font-bold text-red-700 mb-2">Please correct the following errors:</h4>
                        <ul class="mt-2 list-disc list-inside text-red-600 text-sm space-y-1">
                            {% for field in form %}
                                {% if field.errors %}
                                    {% for error in field.errors %}
                                        <li><strong>{{ field.label }}:</strong> {{ error }}</li>
                                    {% endfor %}
                                {% endif %}
                            {% endfor %}
                            {% for error in form.non_field_errors %}
                                <li>{{ error }}</li>
                            {% endfor %}
                        </ul>
                    </div>
                </div>
            </div>
            {% endif %}

            <!-- Enhanced Content Container -->
            <div class="mt-8 sm:mt-10 relative">
                <div class="absolute inset-0 bg-gradient-to-br from-[hsl(var(--primary)/0.02)] to-[hsl(var(--accent)/0.02)] opacity-50 blur-3xl rounded-2xl"></div> {# MODIFIED: Reduced opacity for a softer glow #}
                <div class="relative bg-[hsl(var(--background-content))] border-2 border-[hsl(var(--border))] rounded-2xl p-6 sm:p-8 shadow-xl"> {# MODIFIED: Custom variable for content background #}
                    {% for fieldset in form.fieldsets %}
                    <div
                        id="content-{{ fieldset.title|slugify }}"
                        role="tabpanel"
                        class="transition-all duration-300 {% if not forloop.first %}hidden opacity-0{% endif %} grid grid-cols-1 lg:grid-cols-2 xl:grid-cols-3 gap-6 sm:gap-8"
                    >
                        {% for field_name in fieldset.fields %}
                            {% for field in form %}
                                {% if field.name == field_name %}
                                    <div class="field-container {% if field.field.widget.input_type == 'select-multiple' or field.field.widget.input_type == 'file' or field.field.widget.input_type == 'textarea' %}col-span-1 lg:col-span-2 xl:col-span-3{% elif field.field.widget.input_type == 'checkbox' and field.field.choices %}col-span-1 lg:col-span-2{% endif %}">
                                        {% if field.field.widget.input_type == 'text' or field.field.widget.input_type == 'email' or field.field.widget.input_type == 'password' or field.field.widget.input_type == 'number' %}
                                        <!-- Enhanced Text, Email, Password, Number Input -->
                                        <div class="relative group">
                                            <input type="{{ field.field.widget.input_type }}" 
                                                id="{{ field.id_for_label }}" 
                                                name="{{ field.name }}"
                                                class="peer w-full px-4 py-4 rounded-xl premium-input border-2 {% if field.errors %}border-red-500 bg-red-50{% else %}border-[hsl(var(--border))]{% endif %} bg-[hsl(var(--background-input))] text-[hsl(var(--foreground))] transition-all duration-300 focus:outline-none focus:border-[hsl(var(--primary))] focus:ring-4 focus:ring-[hsl(var(--primary)/0.1)] focus:bg-[hsl(var(--accent)/0.05)] placeholder-transparent {% if field.field.widget.attrs.readonly %}bg-[hsl(var(--muted))] cursor-not-allowed{% endif %} {% if is_disabled %}cursor-not-allowed opacity-70{% endif %} text-base font-medium shadow-sm hover:shadow-md group-hover:border-[hsl(var(--primary)/0.5)]" 
                                                placeholder="{{ field.label }}"
                                                value="{{ field.value|default:'' }}"
                                                {% if field.field.required %}required{% endif %}
                                                {% if field.field.widget.attrs.readonly %}readonly{% endif %}
                                                {% if field.field.widget.attrs.min %}min="{{ field.field.widget.attrs.min }}"{% endif %}
                                                {% if field.field.widget.attrs.max %}max="{{ field.field.widget.attrs.max }}"{% endif %}
                                                {% if field.field.widget.attrs.step %}step="{{ field.field.widget.attrs.step }}"{% endif %}
                                                {% if is_disabled %}disabled{% endif %}>
                                            <label for="{{ field.id_for_label }}" 
                                                class="absolute left-4 -top-3 px-2 text-sm font-semibold transition-all duration-300 bg-[hsl(var(--background-content))] {% if field.errors %}text-red-500{% else %}text-[hsl(var(--muted-foreground))]{% endif %} peer-focus:-top-3 peer-focus:text-sm peer-focus:text-[hsl(var(--primary))] peer-placeholder-shown:top-4 peer-placeholder-shown:text-base peer-placeholder-shown:text-[hsl(var(--muted-foreground))] group-hover:text-[hsl(var(--primary))]">
                                                {{ field.label }}{% if field.field.required %}<span class="text-red-500 ml-1">*</span>{% endif %}
                                            </label>
                                            {% if field.errors %}
                                                <div class="text-red-500 text-sm mt-2 font-medium">
                                                    {% for error in field.errors %}
                                                        <p class="flex items-center gap-2">
                                                            <svg class="w-4 h-4" viewBox="0 0 24 24" fill="none">
                                                                <circle cx="12" cy="12" r="10" stroke="currentColor" stroke-width="2"/>
                                                                <path d="M12 8V12" stroke="currentColor" stroke-width="2"/>
                                                                <path d="M12 16H12.01" stroke="currentColor" stroke-width="2"/>
                                                            </svg>
                                                            {{ error }}
                                                        </p>
                                                    {% endfor %}
                                                </div>
                                            {% endif %}
                                        </div>

                                        {% elif field.field.widget.input_type == 'date' %}
                                            <!-- Enhanced Date Input -->
                                            <div class="relative group">
                                                <input type="date" 
                                                    id="{{ field.id_for_label }}" 
                                                    name="{{ field.name }}"
                                                    class="peer w-full px-4 py-4 rounded-xl premium-input border-2 {% if field.errors %}border-red-500 bg-red-50{% else %}border-[hsl(var(--border))]{% endif %} bg-[hsl(var(--background-input))] text-[hsl(var(--foreground))] transition-all duration-300 focus:outline-none focus:border-[hsl(var(--primary))] focus:ring-4 focus:ring-[hsl(var(--primary)/0.1)] focus:bg-[hsl(var(--accent)/0.05)] {% if is_disabled %}cursor-not-allowed opacity-70{% endif %} text-base font-medium shadow-sm hover:shadow-md group-hover:border-[hsl(var(--primary)/0.5)]" 
                                                    value="{{ field.value|date:'Y-m-d'|default:'' }}"
                                                    {% if field.field.required %}required{% endif %}
                                                    {% if is_disabled %}disabled{% endif %}>
                                                <label for="{{ field.id_for_label }}" 
                                                    class="absolute left-4 -top-3 px-2 text-sm font-semibold transition-all duration-300 bg-[hsl(var(--background-content))] {% if field.errors %}text-red-500{% else %}text-[hsl(var(--muted-foreground))]{% endif %} peer-focus:text-[hsl(var(--primary))] group-hover:text-[hsl(var(--primary))]">
                                                    {{ field.label }}{% if field.field.required %}<span class="text-red-500 ml-1">*</span>{% endif %}
                                                </label>
                                                {% if field.errors %}
                                                    <div class="text-red-500 text-sm mt-2 font-medium">
                                                        {% for error in field.errors %}
                                                            <p class="flex items-center gap-2">
                                                                <svg class="w-4 h-4" viewBox="0 0 24 24" fill="none">
                                                                    <circle cx="12" cy="12" r="10" stroke="currentColor" stroke-width="2"/>
                                                                    <path d="M12 8V12" stroke="currentColor" stroke-width="2"/>
                                                                    <path d="M12 16H12.01" stroke="currentColor" stroke-width="2"/>
                                                                </svg>
                                                                {{ error }}
                                                            </p>
                                                        {% endfor %}
                                                    </div>
                                                {% endif %}
                                            </div>

                                        {% elif field.field.widget.input_type == 'select' %}
                                            <!-- Enhanced Select Input -->
                                            <div class="relative group">
                                                <select id="{{ field.id_for_label }}" 
                                                    name="{{ field.name }}"
                                                    class="peer w-full px-4 py-4 rounded-xl premium-input border-2 {% if field.errors %}border-red-500 bg-red-50{% else %}border-[hsl(var(--border))]{% endif %} bg-[hsl(var(--background-input))] text-[hsl(var(--foreground))] transition-all duration-300 focus:outline-none focus:border-[hsl(var(--primary))] focus:ring-4 focus:ring-[hsl(var(--primary)/0.1)] focus:bg-[hsl(var(--accent)/0.05)] appearance-none {% if is_disabled %}cursor-not-allowed opacity-70{% endif %} text-base font-medium shadow-sm hover:shadow-md group-hover:border-[hsl(var(--primary)/0.5)]"
                                                    {% if field.field.required %}required{% endif %}
                                                    {% if is_disabled %}disabled{% endif %}>
                                                    <option value="" disabled {% if not field.value %}selected{% endif %}></option>
                                                    {% for choice in field.field.choices %}
                                                        <option value="{{ choice.0 }}" 
                                                            class="py-3 bg-[hsl(var(--background-input))] text-[hsl(var(--foreground))] hover:bg-[hsl(var(--primary))] hover:text-[hsl(var(--primary-foreground))]"
                                                            {% if field.value|stringformat:"s" == choice.0|stringformat:"s" %}selected{% endif %}>
                                                            {{ choice.1 }}
                                                        </option>
                                                    {% endfor %}
                                                </select>
                                                <label for="{{ field.id_for_label }}" 
                                                    class="absolute left-4 -top-3 px-2 text-sm font-semibold transition-all duration-300 bg-[hsl(var(--background-content))] {% if field.errors %}text-red-500{% else %}text-[hsl(var(--muted-foreground))]{% endif %} peer-focus:text-[hsl(var(--primary))] group-hover:text-[hsl(var(--primary))]">
                                                    {{ field.label }}{% if field.field.required %}<span class="text-red-500 ml-1">*</span>{% endif %}
                                                </label>
                                                <svg class="absolute right-4 top-5 w-5 h-5 pointer-events-none text-[hsl(var(--muted-foreground))] group-hover:text-[hsl(var(--primary))] transition-colors" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                                                    <path d="M6 9L12 15L18 9" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                                                </svg>
                                                {% if field.errors %}
                                                    <div class="text-red-500 text-sm mt-2 font-medium">
                                                        {% for error in field.errors %}
                                                            <p class="flex items-center gap-2">
                                                                <svg class="w-4 h-4" viewBox="0 0 24 24" fill="none">
                                                                    <circle cx="12" cy="12" r="10" stroke="currentColor" stroke-width="2"/>
                                                                    <path d="M12 8V12" stroke="currentColor" stroke-width="2"/>
                                                                    <path d="M12 16H12.01" stroke="currentColor" stroke-width="2"/>
                                                                </svg>
                                                                {{ error }}
                                                            </p>
                                                        {% endfor %}
                                                    </div>
                                                {% endif %}
                                            </div>

                                        {% elif field.field.widget.input_type == 'textarea' %}
                                            <!-- Enhanced Textarea -->
                                            <div class="relative group col-span-1 lg:col-span-2 xl:col-span-3">
                                                <textarea id="{{ field.id_for_label }}" 
                                                    name="{{ field.name }}" 
                                                    rows="5" 
                                                    class="peer w-full px-4 py-4 rounded-xl premium-input border-2 {% if field.errors %}border-red-500 bg-red-50{% else %}border-[hsl(var(--border))]{% endif %} bg-[hsl(var(--background-input))] text-[hsl(var(--foreground))] transition-all duration-300 focus:outline-none focus:border-[hsl(var(--primary))] focus:ring-4 focus:ring-[hsl(var(--primary)/0.1)] focus:bg-[hsl(var(--accent)/0.05)] placeholder-transparent {% if is_disabled %}cursor-not-allowed opacity-70{% endif %} text-base font-medium shadow-sm hover:shadow-md group-hover:border-[hsl(var(--primary)/0.5)] resize-y min-h-[120px]" 
                                                    placeholder="{{ field.label }}"
                                                    {% if field.field.required %}required{% endif %}
                                                    {% if is_disabled %}disabled{% endif %}>{{ field.value|default:'' }}</textarea>
                                                <label for="{{ field.id_for_label }}" 
                                                    class="absolute left-4 -top-3 px-2 text-sm font-semibold transition-all duration-300 bg-[hsl(var(--background-content))] {% if field.errors %}text-red-500{% else %}text-[hsl(var(--muted-foreground))]{% endif %} peer-focus:text-[hsl(var(--primary))] group-hover:text-[hsl(var(--primary))]">
                                                    {{ field.label }}{% if field.field.required %}<span class="text-red-500 ml-1">*</span>{% endif %}
                                                </label>
                                                {% if field.errors %}
                                                    <div class="text-red-500 text-sm mt-2 font-medium">
                                                        {% for error in field.errors %}
                                                            <p class="flex items-center gap-2">
                                                                <svg class="w-4 h-4" viewBox="0 0 24 24" fill="none">
                                                                    <circle cx="12" cy="12" r="10" stroke="currentColor" stroke-width="2"/>
                                                                    <path d="M12 8V12" stroke="currentColor" stroke-width="2"/>
                                                                    <path d="M12 16H12.01" stroke="currentColor" stroke-width="2"/>
                                                                </svg>
                                                                {{ error }}
                                                            </p>
                                                        {% endfor %}
                                                    </div>
                                                {% endif %}
                                            </div>

                                        {% elif field.field.widget.input_type == 'checkbox' %}
                                            {% if field.field.choices %}
                                                <!-- Enhanced Checkbox Group -->
                                                <fieldset class="space-y-4 bg-gradient-to-br from-[hsl(var(--background-checkbox-group-start))] to-[hsl(var(--background-checkbox-group-end))] rounded-xl premium-input p-6 border-2 {% if field.errors %}border-red-500{% else %}border-[hsl(var(--border))]{% endif %} shadow-sm col-span-1 lg:col-span-2"> {# MODIFIED: Custom variables for checkbox group background #}
                                                    <legend class="text-base font-bold px-3 -ml-1 {% if field.errors %}text-red-500{% endif %} mb-4">{{ field.label }}{% if field.field.required %}<span class="text-red-500 ml-1">*</span>{% endif %}</legend>
                                                    <div class="grid grid-cols-1 sm:grid-cols-2 gap-4">
                                                    {% for choice in field.field.choices %}
                                                        <div class="flex items-center p-4 rounded-xl premium-input border-2 border-[hsl(var(--border))] hover:border-[hsl(var(--primary))] hover:bg-[hsl(var(--accent)/0.05)] transition-all duration-300 group cursor-pointer"> {# MODIFIED: Softer hover background for checkbox items #}
                                                            <input type="checkbox" 
                                                                id="{{ field.id_for_label }}_{{ forloop.counter }}" 
                                                                name="{{ field.name }}" 
                                                                value="{{ choice.0 }}"
                                                                class="appearance-none w-6 h-6 rounded-lg border-2 {% if field.errors %}border-red-500{% else %}border-[hsl(var(--border))]{% endif %} checked:bg-[hsl(var(--primary))] checked:border-[hsl(var(--primary))] relative cursor-pointer transition-all duration-300 after:content-[''] after:absolute after:opacity-0 after:w-2 after:h-3 after:border-r-2 after:border-b-2 after:border-[hsl(var(--primary-foreground))] after:rotate-45 after:top-1/2 after:left-1/2 after:-translate-y-[60%] after:-translate-x-1/2 checked:after:opacity-100 mr-4 group-hover:border-[hsl(var(--primary))] {% if is_disabled %}cursor-not-allowed opacity-70{% endif %}"
                                                                {% if choice.0 in field.value %}checked{% endif %}
                                                                {% if is_disabled %}disabled{% endif %}>
                                                            <label for="{{ field.id_for_label }}_{{ forloop.counter }}" class="text-[hsl(var(--foreground))] cursor-pointer text-base font-medium group-hover:text-[hsl(var(--primary))] transition-colors">{{ choice.1 }}</label>
                                                        </div>
                                                    {% endfor %}
                                                    </div>
                                                    {% if field.errors %}
                                                        <div class="text-red-500 text-sm mt-3 font-medium">
                                                            {% for error in field.errors %}
                                                                <p class="flex items-center gap-2">
                                                                    <svg class="w-4 h-4" viewBox="0 0 24 24" fill="none">
                                                                        <circle cx="12" cy="12" r="10" stroke="currentColor" stroke-width="2"/>
                                                                        <path d="M12 8V12" stroke="currentColor" stroke-width="2"/>
                                                                        <path d="M12 16H12.01" stroke="currentColor" stroke-width="2"/>
                                                                    </svg>
                                                                    {{ error }}
                                                                </p>
                                                            {% endfor %}
                                                        </div>
                                                    {% endif %}
                                                </fieldset>
                                            {% else %}
                                                <!-- Enhanced Single Checkbox / Toggle -->
                                                <div class="flex items-center gap-4 bg-gradient-to-br from-[hsl(var(--background-checkbox-start))] to-[hsl(var(--background-checkbox-end))] rounded-xl premium-input p-6 border-2 {% if field.errors %}border-red-500{% else %}border-[hsl(var(--border))]{% endif %} shadow-sm hover:shadow-md transition-all duration-300 group"> {# MODIFIED: Custom variables for single checkbox background #}
                                                    <label class="relative inline-flex items-center cursor-pointer">
                                                        <input type="checkbox" 
                                                            id="{{ field.id_for_label }}" 
                                                            name="{{ field.name }}" 
                                                            class="sr-only peer"
                                                            {% if field.value %}checked{% endif %}
                                                            {% if field.field.required %}required{% endif %}
                                                            {% if is_disabled %}disabled{% endif %}>
                                                        <div class="w-14 h-7 bg-[hsl(var(--muted))] peer-focus:outline-none rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-6 after:w-6 after:transition-all peer-checked:bg-[hsl(var(--primary))] shadow-inner {% if is_disabled %}cursor-not-allowed opacity-70{% endif %}"></div>
                                                        <span class="ml-4 text-base font-semibold {% if field.errors %}text-red-500{% endif %} group-hover:text-[hsl(var(--primary))] transition-colors">{{ field.label }}{% if field.field.required %}<span class="text-red-500 ml-1">*</span>{% endif %}</span>
                                                    </label>
                                                    {% if field.errors %}
                                                        <div class="text-red-500 text-sm mt-2 font-medium">
                                                            {% for error in field.errors %}
                                                                <p class="flex items-center gap-2">
                                                                    <svg class="w-4 h-4" viewBox="0 0 24 24" fill="none">
                                                                        <circle cx="12" cy="12" r="10" stroke="currentColor" stroke-width="2"/>
                                                                        <path d="M12 8V12" stroke="currentColor" stroke-width="2"/>
                                                                        <path d="M12 16H12.01" stroke="currentColor" stroke-width="2"/>
                                                                </svg>
                                                                {{ error }}
                                                            </p>
                                                        {% endfor %}
                                                    </div>
                                                {% endif %}
                                                </div>
                                            {% endif %}

                                        {% else %}
                                            <!-- Fallback for any other field types -->
                                            <div class="relative group">
                                                <label for="{{ field.id_for_label }}" class="block text-base font-semibold mb-3 {% if field.errors %}text-red-500{% endif %} group-hover:text-[hsl(var(--primary))] transition-colors">
                                                    {{ field.label }}{% if field.field.required %}<span class="text-red-500 ml-1">*</span>{% endif %}
                                                </label>
                                                <div class="relative">
                                                    {{ field }}
                                                </div>
                                                {% if field.errors %}
                                                    <div class="text-red-500 text-sm mt-2 font-medium">
                                                        {% for error in field.errors %}
                                                            <p class="flex items-center gap-2">
                                                                <svg class="w-4 h-4" viewBox="0 0 24 24" fill="none">
                                                                    <circle cx="12" cy="12" r="10" stroke="currentColor" stroke-width="2"/>
                                                                    <path d="M12 8V12" stroke="currentColor" stroke-width="2"/>
                                                                    <path d="M12 16H12.01" stroke="currentColor" stroke-width="2"/>
                                                                </svg>
                                                                {{ error }}
                                                            </p>
                                                        {% endfor %}
                                                    </div>
                                                {% endif %}
                                            </div>
                                        {% endif %}
                                        {% if field.help_text %}
                                            <p class="mt-3 text-sm text-[hsl(var(--muted-foreground))] font-medium bg-[hsl(var(--background-help-text))] rounded-lg p-3 border border-[hsl(var(--border))]"> {# MODIFIED: Custom variable for help text background #}
                                                <svg class="w-4 h-4 inline mr-2" viewBox="0 0 24 24" fill="none">
                                                    <circle cx="12" cy="12" r="10" stroke="currentColor" stroke-width="2"/>
                                                    <path d="M9.09 9A3 3 0 0 1 12 6C13.66 6 15 7.34 15 9C15 10.66 13.66 12 12 12" stroke="currentColor" stroke-width="2"/>
                                                    <path d="M12 17H12.01" stroke="currentColor" stroke-width="2"/>
                                                </svg>
                                                {{ field.help_text }}
                                            </p>
                                        {% endif %}
                                    </div>
                                {% endif %}
                            {% endfor %}
                        {% endfor %}
                    </div>
                    {% endfor %}
                </div>
            </div>

            <!-- Enhanced Form Footer -->
            <div class="border-t-2 border-[hsl(var(--border))] pt-8 sm:pt-10 flex flex-col sm:flex-row justify-between items-center gap-6 sm:gap-8 relative z-10">
                <div class="text-sm sm:text-base text-[hsl(var(--muted-foreground))] font-medium">
            {% include "common/toast.html" %}

                </div>
                <div class="flex gap-4 sm:gap-6 w-full sm:w-auto">
                    {% if cancel_url %}
                    <a href="{{ cancel_url }}" class="flex-1 sm:flex-initial inline-flex items-center justify-center rounded-xl premium-input text-base font-semibold ring-offset-background transition-all duration-300 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 bg-[hsl(var(--secondary))] text-[hsl(var(--secondary-foreground))] hover:opacity-90 hover:shadow-lg h-12 sm:h-14 px-6 sm:px-8 py-3 shadow-md border-2 border-[hsl(var(--border))] hover:border-[hsl(var(--primary)/0.3)]">
                        <svg class="w-5 h-5 mr-2" viewBox="0 0 24 24" fill="none">
                            <path d="M18 6L6 18M6 6L18 18" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                        </svg>
                        Cancel
                    </a>
                    {% endif %}
                    <button type="submit" class="flex-1 sm:flex-initial inline-flex items-center justify-center rounded-xl premium-input text-base font-bold ring-offset-background transition-all duration-300 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 bg-gradient-to-r from-[hsl(var(--primary)/0.9)] to-[hsl(var(--primary)/1.1)] text-[hsl(var(--primary-foreground))] hover:opacity-90 hover:shadow-xl hover:scale-105 h-12 sm:h-14 px-6 sm:px-8 py-3 shadow-lg premium-button">
                        <svg class="w-5 h-5 sm:w-6 sm:h-6 mr-3" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                            <path d="M5 12L10 17L20 7" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                        </svg>
                        Save Changes
                    </button>
                </div>
            </div>
        </form>

        <!-- Enhanced Stock Display Table -->
        {% if stock_display %}
        <div class="mt-8 sm:mt-10 overflow-x-auto rounded-2xl border-2 border-[hsl(var(--border))] shadow-lg">
            <table class="w-full text-base text-left text-[hsl(var(--foreground))]">
                <thead class="text-sm uppercase bg-gradient-to-r from-[hsl(var(--background-table-header-start))] to-[hsl(var(--background-table-header-end))] font-bold"> {# MODIFIED: Custom variables for table header background #}
                    <tr>
                        <th scope="col" class="px-6 sm:px-8 py-4 sm:py-5">In Stock</th>
                        <th scope="col" class="px-6 sm:px-8 py-4 sm:py-5">Committed</th>
                        <th scope="col" class="px-6 sm:px-8 py-4 sm:py-5">Available</th>
                        <th scope="col" class="px-6 sm:px-8 py-4 sm:py-5">Ordered</th>
                    </tr>
                </thead>
                <tbody>
                    <tr class="bg-[hsl(var(--background-table-row))] border-b-2 border-[hsl(var(--border))] hover:bg-[hsl(var(--accent)/0.05)] transition-colors"> {# MODIFIED: Custom variable for table row background and softer hover #}
                        <td class="px-6 sm:px-8 py-4 sm:py-6 font-semibold">{{ stock_display.in_stock }}</td>
                        <td class="px-6 sm:px-8 py-4 sm:py-6 font-semibold">{{ stock_display.committed }}</td>
                        <td class="px-6 sm:px-8 py-4 sm:py-6 font-semibold">{{ stock_display.available }}</td>
                        <td class="px-6 sm:px-8 py-4 sm:py-6 font-semibold">{{ stock_display.ordered }}</td>
                    </tr>
                </tbody>
            </table>
        </div>
        {% endif %}
    </div>
</div>

<script>
    document.addEventListener('DOMContentLoaded', function() {
        const tabs = [
            {% for fieldset in form.fieldsets %}
            {
                id: "{{ fieldset.title|slugify }}",
                title: "{{ fieldset.title }}",
                description: "{{ fieldset.description }}"
            },
            {% endfor %}
        ];

        let activeTab = tabs[0].id;
        const tabsContainer = document.getElementById('tabsContainer');
        const scrollLeftBtn = document.getElementById('scrollLeft');
        const scrollRightBtn = document.getElementById('scrollRight');
        const leftGradient = document.getElementById('leftGradient');
        const rightGradient = document.getElementById('rightGradient');

        // Enhanced tab switching with scroll-to-view
        function switchTab(tabId) {
            activeTab = tabId;

            tabs.forEach(tab => {
                const button = document.getElementById(`tab-${tab.id}`);
                const content = document.getElementById(`content-${tab.id}`);
                const indicator = document.querySelector(`[data-tab="${tab.id}"].tab-indicator`);
                
                if (tab.id === activeTab) {
                    // Activate tab button
                    button.classList.add('bg-gradient-to-r', 'from-[hsl(var(--primary)/0.9)]', 'to-[hsl(var(--primary)/1.1)]', 'text-[hsl(var(--primary-foreground))]', 'shadow-lg', 'active-tab');
                    button.classList.remove('text-[hsl(var(--muted-foreground))]', 'bg-[hsl(var(--background-tab-inactive))]', 'hover:bg-[hsl(var(--accent))]', 'hover:text-[hsl(var(--accent-foreground))]', 'border-2', 'border-[hsl(var(--border-light))]'); {# MODIFIED: Removed old inactive classes #}
                    button.querySelector('div:first-child').classList.add('scale-110');
                    
                    // Show content
                    content.classList.remove('hidden', 'opacity-0');
                    setTimeout(() => {
                        content.classList.add('opacity-100');
                    }, 10);
                    
                    // Update mobile indicator
                    if (indicator) {
                        indicator.classList.add('bg-[hsl(var(--primary))]', 'scale-125');
                        indicator.classList.remove('bg-[hsl(var(--muted))]');
                    }
                    
                    // Scroll active tab into view
                    scrollTabIntoView(button);
                } else {
                    // Deactivate tab button
                    button.classList.remove('bg-gradient-to-r', 'from-[hsl(var(--primary)/0.9)]', 'to-[hsl(var(--primary)/1.1)]', 'text-[hsl(var(--primary-foreground))]', 'shadow-lg', 'active-tab');
                    button.classList.add('text-[hsl(var(--muted-foreground))]', 'bg-[hsl(var(--background-tab-inactive))]', 'hover:bg-[hsl(var(--accent))]', 'hover:text-[hsl(var(--accent-foreground))]', 'border-2', 'border-[hsl(var(--border-light))]'); {# MODIFIED: Added new inactive classes #}
                    button.querySelector('div:first-child').classList.remove('scale-110');
                    
                    // Hide content
                    content.classList.add('opacity-0');
                    setTimeout(() => {
                        content.classList.add('hidden');
                    }, 300);
                    
                    // Update mobile indicator
                    if (indicator) {
                        indicator.classList.remove('bg-[hsl(var(--primary))]', 'scale-125');
                        indicator.classList.add('bg-[hsl(var(--muted))]');
                    }
                }
            });
        }

        // Scroll active tab into view
        function scrollTabIntoView(tabButton) {
            if (!tabsContainer || !tabButton) return;
            
            const containerRect = tabsContainer.getBoundingClientRect();
            const buttonRect = tabButton.getBoundingClientRect();
            const containerScrollLeft = tabsContainer.scrollLeft;
            
            // Calculate if button is outside visible area
            const isLeftOutside = buttonRect.left < containerRect.left;
            const isRightOutside = buttonRect.right > containerRect.right;
            
            if (isLeftOutside || isRightOutside) {
                const buttonOffsetLeft = tabButton.offsetLeft;
                const buttonWidth = tabButton.offsetWidth;
                const containerWidth = tabsContainer.offsetWidth;
                
                let scrollTo;
                if (isLeftOutside) {
                    scrollTo = buttonOffsetLeft - 20; // 20px padding
                } else {
                    scrollTo = buttonOffsetLeft - containerWidth + buttonWidth + 20; // 20px padding
                }
                
                tabsContainer.scrollTo({
                    left: Math.max(0, scrollTo),
                    behavior: 'smooth'
                });
            }
        }

        // Enhanced scroll button functionality
        function scrollTabs(direction) {
            if (!tabsContainer) return;
            
            const scrollAmount = 200;
            const currentScroll = tabsContainer.scrollLeft;
            const targetScroll = direction === 'left' 
                ? Math.max(0, currentScroll - scrollAmount)
                : currentScroll + scrollAmount;
            
            tabsContainer.scrollTo({
                left: targetScroll,
                behavior: 'smooth'
            });
        }

        // Update scroll indicators and buttons
        function updateScrollIndicators() {
            if (!tabsContainer) return;
            
            const { scrollLeft, scrollWidth, clientWidth } = tabsContainer;
            const maxScroll = scrollWidth - clientWidth;
            
            // Update gradient indicators
            if (leftGradient) {
                leftGradient.style.opacity = scrollLeft > 10 ? '1' : '0';
            }
            if (rightGradient) {
                rightGradient.style.opacity = scrollLeft < maxScroll - 10 ? '1' : '0';
            }
            
            // Update scroll buttons (desktop)
            if (scrollLeftBtn) {
                scrollLeftBtn.style.opacity = scrollLeft > 10 ? '1' : '0.5';
                scrollLeftBtn.style.pointerEvents = scrollLeft > 10 ? 'auto' : 'none';
            }
            if (scrollRightBtn) {
                scrollRightBtn.style.opacity = scrollLeft < maxScroll - 10 ? '1' : '0.5';
                scrollRightBtn.style.pointerEvents = scrollLeft < maxScroll - 10 ? 'auto' : 'none';
            }
        }

        // Touch/swipe support for mobile
        let touchStartX = 0;
        let touchEndX = 0;
        let isScrolling = false;

        function handleTouchStart(e) {
            touchStartX = e.touches[0].clientX;
            isScrolling = false;
        }

        function handleTouchMove(e) {
            if (!isScrolling) {
                isScrolling = true;
            }
        }

        function handleTouchEnd(e) {
            if (!isScrolling) return;
            
            touchEndX = e.changedTouches[0].clientX;
            const swipeThreshold = 50;
            const swipeDistance = touchStartX - touchEndX;
            
            if (Math.abs(swipeDistance) > swipeThreshold) {
                if (swipeDistance > 0) {
                    // Swiped left - scroll right
                    scrollTabs('right');
                } else {
                    // Swiped right - scroll left
                    scrollTabs('left');
                }
            }
        }

        // Event listeners
        tabs.forEach(tab => {
            const button = document.getElementById(`tab-${tab.id}`);
            if (button) {
                button.addEventListener('click', () => switchTab(tab.id));
            }
        });

        // Scroll button event listeners
        if (scrollLeftBtn) {
            scrollLeftBtn.addEventListener('click', () => scrollTabs('left'));
        }
        if (scrollRightBtn) {
            scrollRightBtn.addEventListener('click', () => scrollTabs('right'));
        }

        // Scroll event listener
        if (tabsContainer) {
            tabsContainer.addEventListener('scroll', updateScrollIndicators);
            
            // Touch events for mobile
            tabsContainer.addEventListener('touchstart', handleTouchStart, { passive: true });
            tabsContainer.addEventListener('touchmove', handleTouchMove, { passive: true });
            tabsContainer.addEventListener('touchend', handleTouchEnd, { passive: true });
        }

        // Keyboard navigation
        document.addEventListener('keydown', function(e) {
            if (e.target.closest('.tabs-container')) {
                const currentIndex = tabs.findIndex(tab => tab.id === activeTab);
                let newIndex = currentIndex;
                
                if (e.key === 'ArrowLeft' && currentIndex > 0) {
                    newIndex = currentIndex - 1;
                } else if (e.key === 'ArrowRight' && currentIndex < tabs.length - 1) {
                    newIndex = currentIndex + 1;
                }
                
                if (newIndex !== currentIndex) {
                    e.preventDefault();
                    switchTab(tabs[newIndex].id);
                }
            }
        });

        // Resize handler
        let resizeTimeout;
        window.addEventListener('resize', function() {
            clearTimeout(resizeTimeout);
            resizeTimeout = setTimeout(() => {
                updateScrollIndicators();
                // Re-scroll active tab into view on resize
                const activeButton = document.querySelector('.active-tab');
                if (activeButton) {
                    scrollTabIntoView(activeButton);
                }
            }, 150);
        });

        // Initialize
        updateScrollIndicators();
        
        // Enhanced form validation feedback
        const inputs = document.querySelectorAll('input, select, textarea');
        inputs.forEach(input => {
            input.addEventListener('focus', function() {
                this.closest('.field-container').classList.add('focused');
            });
            
            input.addEventListener('blur', function() {
                this.closest('.field-container').classList.remove('focused');
            });
        });

        // Auto-scroll to active tab on page load
        setTimeout(() => {
            const activeButton = document.querySelector('.active-tab');
            if (activeButton) {
                scrollTabIntoView(activeButton);
            }
        }, 100);
    });
</script>

<style>
    /* New CSS variables for light mode background refinements */
    :root {
        --background-card: 0 0% 100%; /* Main card background */
        --background-tabs-start: 240 4.8% 98%; /* Lighter muted for tabs section */
        --background-tabs-end: 240 4.8% 95.9%; /* Muted for tabs section */
        --background-tab-inactive: 0 0% 100%; /* Inactive tab background */
        --background-content: 0 0% 100%; /* Tab content background */
        --background-input: 0 0% 100%; /* Input field background */
        --background-checkbox-group-start: 240 4.8% 98%; /* Checkbox group background start */
        --background-checkbox-group-end: 240 4.8% 95.9%; /* Checkbox group background end */
        --background-checkbox-start: 240 4.8% 98%; /* Single checkbox background start */
        --background-checkbox-end: 240 4.8% 95.9%; /* Single checkbox background end */
        --background-help-text: 240 4.8% 98%; /* Help text background */
        --background-footer-start: 240 4.8% 98%; /* Footer info background start */
        --background-footer-end: 240 4.8% 95.9%; /* Footer info background end */
        --background-table-header-start: 240 4.8% 98%; /* Table header background start */
        --background-table-header-end: 240 4.8% 95.9%; /* Table header background end */
        --background-table-row: 0 0% 100%; /* Table row background */
        --border-light: 240 5.9% 90%; /* A slightly lighter border for some elements */
    }

    /* Dark mode adjustments for new variables */
    .dark {
        --background-card: 240 10% 3.9%;
        --background-tabs-start: 240 3.7% 10%; /* Slightly darker for tabs section */
        --background-tabs-end: 240 3.7% 15.9%; /* Muted for tabs section */
        --background-tab-inactive: 240 10% 3.9%;
        --background-content: 240 10% 3.9%;
        --background-input: 240 10% 3.9%;
        --background-checkbox-group-start: 240 3.7% 10%;
        --background-checkbox-group-end: 240 3.7% 15.9%;
        --background-checkbox-start: 240 3.7% 10%;
        --background-checkbox-end: 240 3.7% 15.9%;
        --background-help-text: 240 3.7% 10%;
        --background-footer-start: 240 3.7% 10%;
        --background-footer-end: 240 3.7% 15.9%;
        --background-table-header-start: 240 3.7% 10%;
        --background-table-header-end: 240 3.7% 15.9%;
        --background-table-row: 240 10% 3.9%;
        --border-light: 240 3.7% 15.9%;
    }

    /* Enhanced scrollbar hiding */
    .hide-scrollbar::-webkit-scrollbar {
        display: none;
    }
    .hide-scrollbar {
        -ms-overflow-style: none;
        scrollbar-width: none;
    }
    
    /* Enhanced touch-friendly improvements */
    @media (max-width: 640px) {
        input, select, textarea {
            font-size: 16px !important; /* Prevents iOS zoom on focus */
        }
        
        /* Larger touch targets */
        button, 
        [type="button"],
        [type="reset"],
        [type="submit"] {
            min-height: 48px;
        }
        
        /* Enhanced mobile spacing */
        .premium-card {
            border-radius: 16px;
        }
        
        /* Enhanced tab button styling for mobile */
        .tab-button {
            min-width: auto;
            padding: 0.875rem 1rem;
        }
    }
    
    /* Enhanced focus states */
    .field-container.focused {
        transform: translateY(-2px);
        transition: transform 0.2s ease;
    }
    
    /* Enhanced premium animations */
    .premium-button:hover {
        transform: translateY(-2px);
        transition: all 0.3s ease;
    }
    
    .premium-icon {
        background: linear-gradient(135deg, hsl(var(--primary)/0.9), hsl(var(--primary)/1.1));
        box-shadow: 0 8px 32px hsl(var(--primary)/0.3);
    }
    
    /* Enhanced grid responsiveness */
    @media (min-width: 1024px) {
        .grid.lg\:grid-cols-2 {
            grid-template-columns: repeat(2, 1fr);
        }
    }
    
    @media (min-width: 1280px) {
        .grid.xl\:grid-cols-3 {
            grid-template-columns: repeat(3, 1fr);
        }
    }

    /* Custom shadow for a more premium look */
    .shadow-inner-lg {
        box-shadow: inset 0 2px 8px 0 rgba(0, 0, 0, 0.05); /* Softer inner shadow */
    }
</style>
{% endblock %}
