{% extends "common/base-list-modern.html" %}
{% load static %}
{% load i18n %}

{% block list_title %}User Locations{% endblock %}
{% block list_subtitle %}Manage user location assignments{% endblock %}

{% block list_icon %}
<svg class="w-6 h-6 sm:w-7 sm:h-7" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
    <path d="M20 11C20 15.4183 16 19 12 22C8 19 4 15.4183 4 11C4 6.58172 7.58172 3 12 3C16.4183 3 20 6.58172 20 11Z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
    <path d="M12 13C13.6569 13 15 11.6569 15 10C15 8.34315 13.6569 7 12 7C10.3431 7 9 8.34315 9 10C9 11.6569 10.3431 13 12 13Z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
    <path d="M17 3C19.7614 3 22 5.23858 22 8C22 10.7614 19.7614 13 17 13" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
</svg>
{% endblock %}

{% block additional_filters %}
<div class="flex-shrink-0">
    <select name="user" class="w-full px-3 py-2 rounded-md border-2 border-[hsl(var(--border))] bg-transparent text-[hsl(var(--foreground))] transition-all duration-200 focus:outline-none focus:border-[hsl(var(--primary))] focus:ring-1 focus:ring-[hsl(var(--primary))]">
        <option value="">All Users</option>
        {% for user in filter_form.fields.user.queryset %}
        <option value="{{ user.id }}" {% if request.GET.user|add:"0" == user.id %}selected{% endif %}>{{ user.username }}</option>
        {% endfor %}
    </select>
</div>
<div class="flex-shrink-0">
    <select name="location" class="w-full px-3 py-2 rounded-md border-2 border-[hsl(var(--border))] bg-transparent text-[hsl(var(--foreground))] transition-all duration-200 focus:outline-none focus:border-[hsl(var(--primary))] focus:ring-1 focus:ring-[hsl(var(--primary))]">
        <option value="">All Locations</option>
        {% for location in filter_form.fields.location.queryset %}
        <option value="{{ location.id }}" {% if request.GET.location|add:"0" == location.id %}selected{% endif %}>{{ location.name }}</option>
        {% endfor %}
    </select>
</div>
<div class="flex-shrink-0">
    <select name="is_primary" class="w-full px-3 py-2 rounded-md border-2 border-[hsl(var(--border))] bg-transparent text-[hsl(var(--foreground))] transition-all duration-200 focus:outline-none focus:border-[hsl(var(--primary))] focus:ring-1 focus:ring-[hsl(var(--primary))]">
        <option value="">All Status</option>
        <option value="True" {% if request.GET.is_primary == 'True' %}selected{% endif %}>Primary</option>
        <option value="False" {% if request.GET.is_primary == 'False' %}selected{% endif %}>Secondary</option>
    </select>
</div>
{% endblock %}

{% block table_headers %}
<th scope="col" class="px-3 sm:px-6 py-3">User</th>
<th scope="col" class="px-3 sm:px-6 py-3">Location</th>
<th scope="col" class="px-3 sm:px-6 py-3">Status</th>
<th scope="col" class="px-3 sm:px-6 py-3">Created At</th>
<th scope="col" class="px-3 sm:px-6 py-3 text-right">Actions</th>
{% endblock %}

{% block table_body %}
{% for object in objects %}
<tr class="bg-[hsl(var(--background))] border-b border-[hsl(var(--border))] hover:bg-[hsl(var(--accent))]">
    <td class="px-3 sm:px-6 py-4 font-medium">{{ object.user.username }}</td>
    <td class="px-3 sm:px-6 py-4">{{ object.location.name }}</td>
    <td class="px-3 sm:px-6 py-4">
        {% if object.is_primary %}
        <span class="px-2 py-1 text-xs rounded-full bg-green-100 text-green-800">Primary</span>
        {% else %}
        <span class="px-2 py-1 text-xs rounded-full bg-blue-100 text-blue-800">Secondary</span>
        {% endif %}
    </td>
    <td class="px-3 sm:px-6 py-4">{{ object.created_at|date:"Y-m-d H:i" }}</td>
    <td class="px-3 sm:px-6 py-4 text-right">
        <div class="flex justify-end gap-1 sm:gap-2">
            <a href="{% url 'hrm:user_location_detail' object.pk %}" class="inline-flex items-center justify-center rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 border border-[hsl(var(--border))] bg-[hsl(var(--background))] hover:bg-[hsl(var(--accent))] hover:text-[hsl(var(--accent-foreground))] h-9 px-3 py-2">
                <svg class="w-4 h-4" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <path d="M2 12C2 12 5.63636 5 12 5C18.3636 5 22 12 22 12C22 12 18.3636 19 12 19C5.63636 19 2 12 2 12Z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                    <path d="M12 15C13.6569 15 15 13.6569 15 12C15 10.3431 13.6569 9 12 9C10.3431 9 9 10.3431 9 12C9 13.6569 10.3431 15 12 15Z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                </svg>
            </a>
            <a href="{% url 'hrm:user_location_update' object.pk %}" class="inline-flex items-center justify-center rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 border border-[hsl(var(--border))] bg-[hsl(var(--background))] hover:bg-[hsl(var(--accent))] hover:text-[hsl(var(--accent-foreground))] h-9 px-3 py-2">
                <svg class="w-4 h-4" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <path d="M11 4H4C3.46957 4 2.96086 4.21071 2.58579 4.58579C2.21071 4.96086 2 5.46957 2 6V20C2 20.5304 2.21071 21.0391 2.58579 21.4142C2.96086 21.7893 3.46957 22 4 22H18C18.5304 22 19.0391 21.7893 19.4142 21.4142C19.7893 21.0391 20 20.5304 20 20V13" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                    <path d="M18.5 2.50001C18.8978 2.10219 19.4374 1.87869 20 1.87869C20.5626 1.87869 21.1022 2.10219 21.5 2.50001C21.8978 2.89784 22.1213 3.4374 22.1213 4.00001C22.1213 4.56262 21.8978 5.10219 21.5 5.50001L12 15L8 16L9 12L18.5 2.50001Z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                </svg>
            </a>
            <a href="{% url 'hrm:user_location_delete' object.pk %}" class="inline-flex items-center justify-center rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 border border-[hsl(var(--border))] bg-[hsl(var(--background))] hover:bg-red-100 hover:text-red-700 h-9 px-3 py-2">
                <svg class="w-4 h-4" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <path d="M3 6H5H21" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                    <path d="M8 6V4C8 3.46957 8.21071 2.96086 8.58579 2.58579C8.96086 2.21071 9.46957 2 10 2H14C14.5304 2 15.0391 2.21071 15.4142 2.58579C15.7893 2.96086 16 3.46957 16 4V6M19 6V20C19 20.5304 18.7893 21.0391 18.4142 21.4142C18.0391 21.7893 17.5304 22 17 22H7C6.46957 22 5.96086 21.7893 5.58579 21.4142C5.21071 21.0391 5 20.5304 5 20V6H19Z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                </svg>
            </a>
        </div>
    </td>
</tr>
{% empty %}
<tr class="bg-[hsl(var(--background))] border-b border-[hsl(var(--border))]">
    <td colspan="5" class="px-3 sm:px-6 py-4 text-center text-[hsl(var(--muted-foreground))]">
        No user locations found. <a href="{% url 'hrm:user_location_create' %}" class="text-[hsl(var(--primary))] hover:underline">Assign a location now</a>.
    </td>
</tr>
{% endfor %}
{% endblock %}

{% block empty_colspan %}5{% endblock %}